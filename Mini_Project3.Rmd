---
title: "Mini_Project3"
author: "Nichole, Rowan, Yuqing "
date: "11/13/2017"
output: html_document
---
```{r, message=FALSE}
library(mdsr)
library(RMySQL)
db <- dbConnect_scidb(dbname = "imdb")
big_data<- db%>% 
  dbGetQuery("SELECT ml.movie_id, ml.linked_movie_id, ml.link_type_id, t.title AS movie_title, t2.title AS linked_movie_title, t.production_year AS original_year, t2.production_year AS sequels_year, t2.production_year - t.production_year AS year_difference
FROM movie_link ml
JOIN title t ON ml.movie_id = t.id
JOIN title t2 ON ml.linked_movie_id = t2.id
JOIN movie_info mi On t.id = mi.movie_id
WHERE ml.link_type_id =2 
AND mi.info_type_id = 8
AND info = 'USA'
AND t.kind_id = 1
AND t2.kind_id = 1;")
#using "mi.info_type_id = 8" then filter "info='USA'"is index, saving time of calculation

big_data1<-big_data %>%
  group_by(original_year) %>%
  summarize(total_original=n())

big_data2<-big_data %>%
  group_by(sequels_year) %>%
  summarize(total_sequels=n())

big_data3<-big_data1 %>%
  full_join(big_data2, by=c("original_year"="sequels_year"))
big_data3


library(scales)
ggplot(datm,aes(x = sequels_year, y = ,fill = ind)) + 
    geom_bar(position = "fill",stat = "identity") +
    # or:
    # geom_bar(position = position_fill(), stat = "identity") 
    scale_y_continuous(labels = percent_format())
```

```{r, message=FALSE}

big_data %>%
  filter()


```

